{% extends "base.html" %}
{% load staticfiles %}

{% block extrahead %}
    <script src='{% static "audioplayer/audioplayer.js" %}' type="text/javascript"></script>
    <link rel='stylesheet' type="text/css" href="{% static 'audioplayer/audioplayer.css' %}"/>
{% endblock %}

{% block content %}

    {% if audios %}
        {% for a in audios %}
            <ul class="list-unstyled">
                <li><a href="{{ MEDIA_URL }}{{ a.audio }}">{{ a.title }}</a> - {{ a.added }}</li>
            </ul>
        {% endfor %}
        <hr/>
        {% if current_user %}
            <h1>{{ suser }}</h1>
            <h2>{% for foo in current_user %}
                <a href="{{ foo.permalink_url }}">{{ foo.title }}</a> <br/>
            {% endfor %}
            </h2>
        {% else %}
            Not authorised to soundcloud. <a href="/back/soundcloud/">Login</a> first
        {% endif %}
    {% endif %}
    <hr/>
    <div id="ag1" class="audiogallery" style="opacity:0; padding-top: 70px;">
        <div class="items">
            {% for a in audios %}
                <div class="audioplayer-tobe" style="width:100%; " data-thumb="{{ MEDIA_URL }}{{ a.cover }}" data-bgimage="{% static 'audioplayer/img/bg.jpg' %}" data-scrubbg="{% static 'audioplayer/waves/scrubbg.png' %}" data-scrubprog="{% static 'audioplayer/waves/scrubprog.png' %}" data-videoTitle="Audio Video" data-type="normal" data-source="{{ MEDIA_URL }}{{ a.audio }}" data-sourceogg="{{ MEDIA_URL }}{{ a.audio }}">
                    <div class="meta-artist"><span class="the-artist">{{ a.title }}</span><br/><span class="the-name">{{ a.description }}, {{ a.genre }}, {{ a.privacy }}</div>
                    <div class="menu-description">
                        <div class="menu-item-thumb-con"><div class="menu-item-thumb" style="background-image: url({{ MEDIA_URL }}{{ a.cover }})"></div></div>
                        <span class="the-artist">{{ a.title }}</span>
                        <span class="the-name">{{ a.description }}</span>
                    </div>
                </div>
            {% endfor %}

        </div>
    </div>
    <hr/>
    <form action="{% url "upload_sound" %}" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit" class="btn btn-default">upload</button>
    </form>

    <script>
        jQuery(document).ready(function ($) {
            var settings_ap = {
                disable_volume: 'off'
                ,disable_scrub: 'default'
                ,design_skin: 'skin-wave'
                ,skinwave_dynamicwaves:'on'
            };
            dzsag_init('#ag1',{
                'transition':'fade'
                ,'autoplay' : 'on'
                ,'settings_ap':settings_ap
            });
        });
    </script>
{% endblock %}